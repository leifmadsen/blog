<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sip on Asterisk, and other worldly endeavours</title>
    <link>http://blog.leifmadsen.com/tags/sip/</link>
    <description>Recent content in Sip on Asterisk, and other worldly endeavours</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 11 Oct 2012 20:43:35 +0000</lastBuildDate>
    <atom:link href="http://blog.leifmadsen.com/tags/sip/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Digium D40 and D70 Phone Unboxing</title>
      <link>http://blog.leifmadsen.com/blog/2012/10/11/digium-d40-and-d70-phone-unboxing/</link>
      <pubDate>Thu, 11 Oct 2012 20:43:35 +0000</pubDate>
      
      <guid>http://blog.leifmadsen.com/blog/2012/10/11/digium-d40-and-d70-phone-unboxing/</guid>
      <description>

&lt;p&gt;Today I received a couple of &lt;a href=&#34;http://www1.digium.com/en/products/phones&#34;&gt;phones&lt;/a&gt; from Digium; the D40 and D70. I&amp;rsquo;ll be using these phones for testing and documentation in the 4th edition of &lt;a href=&#34;http://shop.oreilly.com/product/9780596517342.do&#34;&gt;Asterisk: The Definitive Guide&lt;/a&gt; (which &lt;a href=&#34;http://www.coretel.ca/&#34;&gt;Jim Van Meggelen&lt;/a&gt;, &lt;a href=&#34;http://russellbryant.net&#34;&gt;Russell Bryant&lt;/a&gt; and &lt;a href=&#34;http://leifmadsen.com&#34;&gt;myself&lt;/a&gt; are working on right now).&lt;/p&gt;

&lt;p&gt;Here is my unboxing of the phones and some commentary about my initial impressions of the hardware itself.&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_484&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-42-01.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-42-01.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Pretty boxes![/caption]&lt;/p&gt;

&lt;p&gt;Phones arrived in some nice looking boxes.&lt;/p&gt;

&lt;h2 id=&#34;digium-d40:1ed6a47b444c6fccdf649002ba4cb4ed&#34;&gt;Digium D40&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-42-33.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-42-33.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-42-59.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-42-59.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Comes with a little pamphlet to help you get the phones setup on your network.&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-43-17.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-43-17.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-43-55.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-43-55.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-45-16.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-45-16.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Comes with all the little things you need to get the phone up and running, including a network cable. I was just using POE to power the phone, so I didn&amp;rsquo;t end up with the 5VDC power adapter.
&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-47-01.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-47-01.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Nice looking base. Easy to put onto the phone. Just uses friction to hold the phones on the base. Not sure how well that&amp;rsquo;ll work over time, but this isn&amp;rsquo;t something that should be getting attached and detached a lot. The space for cables in the base is also quite large.&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_491&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-48-58.jpg?w=300&#34; alt=&#34;&#34; /&gt; Holes to mount to wall. Requires adapter.[/caption]&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_492&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-49-36.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-49-36.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Easy access![/caption]&lt;/p&gt;

&lt;p&gt;Lots of space for my hand to plug in cables. Much nicer than any of the Polycom bases where I usually give up and just remove it.&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_495&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-51-00.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-51-00.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Boot screen[/caption]&lt;/p&gt;

&lt;p&gt;Booting up with the Digium logo.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-49-56.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-49-56.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-50-51.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-50-51.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_496&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-54-35.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-54-35.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Handset hook access[/caption]&lt;/p&gt;

&lt;p&gt;The tab on the back here is well designed so that you don&amp;rsquo;t require a tool to pull out and flip around. I prefer to have the hook for the handset so it doesn&amp;rsquo;t fall off the base easily. On the Polycoms (which have the same type of setup) it&amp;rsquo;s nearly impossible to remove with your fingers&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_497&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-56-01.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-56-01.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; D40 vs IP335 size comparison[/caption]&lt;/p&gt;

&lt;p&gt;.Size comparison between the D40 and IP335.&lt;/p&gt;

&lt;h2 id=&#34;digium-d70:1ed6a47b444c6fccdf649002ba4cb4ed&#34;&gt;Digium D70&lt;/h2&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_498&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-57-40.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-57-40.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Open box[/caption]&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_500&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-58-28.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-58-28.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Hidden compartment[/caption]&lt;/p&gt;

&lt;p&gt;[caption id=&amp;ldquo;attachment_503&amp;rdquo; align=&amp;ldquo;aligncenter&amp;rdquo; width=&amp;ldquo;300&amp;rdquo;]&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-00-52.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-00-52.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt; Back of the D70[/caption]&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-57-57.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-57-57.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-58-46.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-58-46.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;
&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-59-58.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-14-59-58.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-01-37.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-01-37.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-03-21.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-03-21.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I don&amp;rsquo;t quite get the base with the wall mount holes, but impossible mounting angles on the base. Must have something to do with the manufacturing process and not having separate molds for footing.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Update: Michael pointed out that the A-frame is actually two separate pieces, so with a (separately purchased) piece, you can attach it to the base and make the system wall mountable. With the number of phones I&amp;rsquo;ve actually wall mounted in deployments (I think the number is only one or two), I think I prefer the 2 options for steep and shallow angles. Neat idea.&lt;/em&gt;
&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-03-34.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-03-34.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;
Side cut outs for cables that I didn&amp;rsquo;t even notice the first time through. Michael pointed out they are for cable management. Nice!&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-05-20.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-05-20.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;Oh my! So much space! Very roomy :)
&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-07-22.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-07-22.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;Side by side comparison of the D70 vs the IP650 w/ sidecar.
&lt;a href=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-08-05.jpg&#34;&gt;&lt;img src=&#34;http://leifmadsen.files.wordpress.com/2012/10/2012-10-11-15-08-05.jpg?w=300&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;Front to back comparison of the D70 vs IP650 w/ sidecar.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Recent SIP Attacks from Amazon EC2</title>
      <link>http://blog.leifmadsen.com/blog/2010/04/13/recent-sip-attacks-from-amazon-ec2/</link>
      <pubDate>Tue, 13 Apr 2010 00:28:38 +0000</pubDate>
      
      <guid>http://blog.leifmadsen.com/blog/2010/04/13/recent-sip-attacks-from-amazon-ec2/</guid>
      <description>&lt;p&gt;Recently (over the weekend and continuing into today) there have been several attacks from Amazon EC2 hosts running scanners looking for open SIP accounts. I&amp;rsquo;ve gathered a couple of links that I think are useful in knowing more about the attacks, along with methods of stopping the attacks. The Joshua Stein blog has a very clever way of stopping the attacks that impressed me.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://jcs.org/notaweblog/2010/04/11/properly_stopping_a_sip_flood&#34;&gt;http://jcs.org/notaweblog/2010/04/11/properly_stopping_a_sip_flood&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.voiptechchat.com/voip/457/amazon-ec2-sip-brute-force-attacks-on-rise/&#34;&gt;http://www.voiptechchat.com/voip/457/amazon-ec2-sip-brute-force-attacks-on-rise/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.stuartsheldon.org/blog/2010/04/sip-brute-force-attack-originating-from-amazon-ec2-hosts/&#34;&gt;http://www.stuartsheldon.org/blog/2010/04/sip-brute-force-attack-originating-from-amazon-ec2-hosts/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Update (2010/04/18): It seems the story has made it at least as far as Slashdot now. I seriously can&amp;rsquo;t believe the lack of response has gone on for so long. I figured by now we&amp;rsquo;d have some sort of official story stating that they are searching for the attacker, or that they have been shut down and that additional security precautions have been implemented, but thus far, nothing is being done. The status quo on something like this from Amazon is actually quite surprising.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://it.slashdot.org/story/10/04/17/2059256/SIP-Attacks-From-Amazon-EC2-Going-Unaddressed&#34;&gt;http://it.slashdot.org/story/10/04/17/2059256/SIP-Attacks-From-Amazon-EC2-Going-Unaddressed&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Using a Nokia E71 with Asterisk (3G or WiFi)</title>
      <link>http://blog.leifmadsen.com/blog/2010/03/19/using-a-nokia-e71-with-asterisk-3g-or-wifi/</link>
      <pubDate>Fri, 19 Mar 2010 16:28:28 +0000</pubDate>
      
      <guid>http://blog.leifmadsen.com/blog/2010/03/19/using-a-nokia-e71-with-asterisk-3g-or-wifi/</guid>
      <description>&lt;p&gt;There was some talk in one of the IRC chat rooms today about someone trying to get their E61i working with Asterisk. I haven&amp;rsquo;t had an issue getting that phone or my E71 phone working, but regardless he was having issues. I figured I might as well spend a little bit of time today going through my configuration, both for my own reference, and so that other people can get their Nokia&amp;rsquo;s setup with Asterisk as well.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ll be using the native SIP client, although I&amp;rsquo;ve had just as good of luck using the Fring application. The advantage to the Fring application is that you can use it with Skype, along with multiple IM clients, and also video! I especially like that the application makes use of the video camera on the front of the phone so that you can use it as a videophone. Using the video on a phone like the iPhone or Nexus One seems useless to me (but I digress!).&lt;/p&gt;

&lt;p&gt;First, lets get our Asterisk configuration setup in &lt;em&gt;sip.conf&lt;/em&gt;. We&amp;rsquo;ll need to make sure we&amp;rsquo;ve setup a &lt;strong&gt;realm&lt;/strong&gt; in &lt;em&gt;sip.conf&lt;/em&gt; as our phone will require it. If you don&amp;rsquo;t, then the default realm is &amp;lsquo;&lt;strong&gt;asterisk&lt;/strong&gt;&amp;rsquo;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;sip.conf&lt;/em&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[general]
realm=pbx.my_asterisk_box.com
disallow=all
allow=ulaw
allow=alaw
srvlookup=yes
pedantic=yes
maxexpiry=360
minexpiry=120
defaultexpirey=120
videosupport=yes

[leifmadsen_cell]
type=friend
secret=super_secret_password
context=devices
nat=yes
canreinvite=no
qualify=no
mailbox=100@default
callerid=Leif Madsen &amp;lt;571&amp;gt;
insecure=invite,port
subscribecontext=subscriptions
disallow=all
allow=g729
allow=ulaw
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Feel free to change or add whatever options you need for your &lt;em&gt;sip.conf&lt;/em&gt;. This is generally what I have working right now. I&amp;rsquo;ve left out all my domain handling and SIP URI stuff this time around. Maybe I&amp;rsquo;ll talk about it in another blog post in the future.&lt;/p&gt;

&lt;p&gt;OK, back to the task at hand. Now that we have our sip.conf file configured, just run &amp;lsquo;sip reload&amp;rsquo; from the Asterisk console, and your settings should be available. You can check to make sure your peer loads up with &amp;lsquo;&lt;strong&gt;sip show peers&lt;/strong&gt;&amp;rsquo; or &amp;lsquo;&lt;strong&gt;sip show peer leifmadsen_cell&lt;/strong&gt;&amp;rsquo; (or whatever you called your configuration.&lt;/p&gt;

&lt;p&gt;The next step up is to configure our Nokia device. These settings should likely be the same on both the E61i and the E71, but I&amp;rsquo;m working from a 400 series firmware on the E71, so your mileage may vary.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Menu &amp;gt; Tools &amp;gt; Settings &amp;gt; Connection &amp;gt; SIP Settings &amp;gt; Options &amp;gt; New SIP Profile &amp;gt; Use default profile&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;**
**&lt;/p&gt;

&lt;p&gt;With the new profile created, we need to modify it for connection to our Asterisk system. Starting at the top we have the following fields: Profile name, Service profile, Default access point, Public user name, Use compression, Registration, Use security, Proxy Server, and Registrar Server. We&amp;rsquo;ll going through each of these and configure the two submenus: Proxy Server and Registrar Server.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Profile name:&lt;/strong&gt; Anything you want. I called mine &amp;ldquo;Business Line&amp;rdquo;
&lt;strong&gt;Service profile:&lt;/strong&gt; _IETF
&lt;strong&gt;Default access point:&lt;/strong&gt; Select either a wifi connection or 3G connection. In my case I&amp;rsquo;m selecting &amp;ldquo;Rogers Internet&amp;rdquo;
&lt;strong&gt;Public user name:&lt;/strong&gt; _sip:leifmadsen_cell@pbx.my_asterisk&lt;em&gt;box.com&lt;/em&gt; (notice how leifmadsen_cell is the same as what we configured in sip.conf)
&lt;strong&gt;Use compression:&lt;/strong&gt; _No
&lt;strong&gt;Registration:&lt;/strong&gt; &lt;em&gt;Always on&lt;/em&gt; (you can set this to &amp;lsquo;When needed&amp;rsquo; if you only want to place outbound calls via VoIP sometimes)
&lt;strong&gt;Use security:&lt;/strong&gt; _No___&lt;/p&gt;

&lt;p&gt;**Proxy Server &amp;gt;
&lt;strong&gt;Proxy server address:&lt;/strong&gt; _pbx.my_asterisk_box.com
&lt;strong&gt;Realm:&lt;/strong&gt; _pbx.my_asterisk_box.com
&lt;strong&gt;Username:&lt;/strong&gt; _leifmadsen_cell
&lt;strong&gt;Password:&lt;/strong&gt; _super_secret_password
&lt;strong&gt;Allow loose routing:&lt;/strong&gt; _Yes
&lt;strong&gt;Transport type:&lt;/strong&gt; _UDP
&lt;strong&gt;Port:&lt;/strong&gt; &lt;em&gt;5060&lt;/em&gt; (unless you&amp;rsquo;ve changed this yourself on your Asterisk box)______**&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Back &amp;gt; Registrar server &amp;gt;
(fill this information out exactly like the Proxy server section)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;At this point, hit the &lt;strong&gt;Back&lt;/strong&gt; button a couple of times to make sure you phone will register. If you&amp;rsquo;re still having issues, double check all your configuration options, and potentially restart the phone. With older firmware versions I&amp;rsquo;ve had issues where if I don&amp;rsquo;t get it perfect the first time and make a change, I have to restart the phone.&lt;/p&gt;

&lt;p&gt;Once we see that we&amp;rsquo;ve registered the device, we need to enable it from another screen so that we can place and receive calls from Asterisk.&lt;/p&gt;

&lt;p&gt;Go back out of the SIP Settings screen to your Connection screen in the Tools menu, then select Internet tel.&lt;/p&gt;

&lt;p&gt;By default you will see a screen that says (no Internet telephone settings).&lt;/p&gt;

&lt;p&gt;Select the Options button and create a new profile. There will be two fields: Name and SIP profiles. By default the SIP profile field should be selected with Business Line (or whatever you called your SIP connection) automatically. The Name field is currently set to Default, but I just renamed it to VoIP. Feel free to name it anything you want.&lt;/p&gt;

&lt;p&gt;Back out of all your menus until you get back to the main screen. You should see an icon in the upper-right hand corner that looks like a telephone hand set on top of a globe. At this point, try dialing one of the extensions on your Asterisk server to see if things are working! I like to try calling my voicemail as it lets me test DTMF as well.&lt;/p&gt;

&lt;p&gt;Below is a (modified) INVITE from the E71 showing what you&amp;rsquo;ll see when the request comes from the phone. The most interesting part is the SDP portion which shows us which codecs the device supports and offers. In the case of the phone and firmware combination I&amp;rsquo;m using, I can use G.711 ulaw and alaw, G729, and iLBC.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;INVITE sip:8500@pbx.my_asterisk_server.com;user=phone SIP/2.0
Route:
Via: SIP/2.0/UDP 10.10.10.84:5060;branch=z9hG4bKlq60dckmalhc6vap06nosen;rport
From: ;tag=mh5gdciapphc6m6506no
To:
Contact:
Supported: 100rel,sec-agree
CSeq: 1252 INVITE
Call-ID: rdw6Iy8zoIfKxg6LzJ7FSPdgBvIb8y
Allow: INVITE,ACK,BYE,CANCEL,REFER,NOTIFY,OPTIONS,PRACK
Expires: 120
Privacy: none
User-Agent: E71-2 RM-346 400.21.013
P-Preferred-Identity: sip:leifmadsen_cell@pbx.my_asterisk_server.com
Max-Forwards: 70
Content-Type: application/sdp
Accept: application/sdp
Content-Length: 447

v=0
o=Nokia-SIPUA 63437257072703500 63437257072703500 IN IP4 10.10.10.84
s=-
c=IN IP4 10.10.10.84
t=0 0
m=audio 49152 RTP/AVP 96 0 8 97 18 98 13
a=sendrecv
a=ptime:20
a=maxptime:200
a=fmtp:96 mode-change-neighbor=1
a=fmtp:18 annexb=no
a=fmtp:98 0-15
a=rtpmap:96 AMR/8000/1
a=rtpmap:0 PCMU/8000/1
a=rtpmap:8 PCMA/8000/1
a=rtpmap:97 iLBC/8000/1
a=rtpmap:18 G729/8000/1
a=rtpmap:98 telephone-event/8000/1
a=rtpmap:13 CN/8000/1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So beyond that, there shouldn&amp;rsquo;t be anything else you need to do. Using the same configuration in sip.conf for Asterisk should also work with Fring. Perhaps I&amp;rsquo;ll create another blog post in the future about using Fring with E71 if there is interest in that. Anyone who wants to try testing out some video calls through my Asterisk box using their Fring video enabled phone, just let me know offline and we&amp;rsquo;ll set something up!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Musings about ENUMplus and ISNs</title>
      <link>http://blog.leifmadsen.com/blog/2010/02/19/musings-about-enumplus-and-isns/</link>
      <pubDate>Fri, 19 Feb 2010 15:38:07 +0000</pubDate>
      
      <guid>http://blog.leifmadsen.com/blog/2010/02/19/musings-about-enumplus-and-isns/</guid>
      <description>

&lt;p&gt;Recently I&amp;rsquo;ve been playing around with a couple of technologies that I haven&amp;rsquo;t used in quite a while; ENUM and ISN. First, a little information on what these technologies are about.&lt;/p&gt;

&lt;h2 id=&#34;isns-and-itads:133b4c6dfdac6adcd5cf93b53302f8ac&#34;&gt;ISNs and ITADs&lt;/h2&gt;

&lt;p&gt;First, lets talk about ISN (ITAD Subscriber Number) and ITAD (Internet Telephony Administrative Domain). I think the &lt;a href=&#34;http://www.freenum.org&#34;&gt;http://www.freenum.org&lt;/a&gt; website does a good job of succinctly describing the problem attempting to be addressed:&lt;/p&gt;

&lt;p&gt;&amp;ldquo;The Freenum/ISN system is 12-digit-keypad (telephone handset) friendly method of providing mapping between users. While the eventual use of email-style URI pointers is the eventual goal for communications identifiers, it is still the case that the majority of the world&amp;rsquo;s telephony users are trapped using a 12-digit keypad for extended numeric entry, and it is for the purposes of these devices that the Freenum system and ISN dialing was designed as a &amp;ldquo;stopgap&amp;rdquo; which may last many years. Using ENUM-like methods and IETF standards but not using telephone numbers, the Freenum/ISN dialing system is designed to initially allow SIP-capable proxies and iPBX systems to connect to each other in a free, open, and protocol agnostic manner over the Internet. Initially focused on SIP voice communications, the platform is hoped to eventually extend to other communications methods as those protocols become more widespread.&amp;rdquo; &amp;ndash; freenum.org&lt;/p&gt;

&lt;p&gt;An ISN is a number that looks like:  100*460&lt;/p&gt;

&lt;p&gt;The ITAD part of that ISN is the number 460 where you can think of the 460 as the domain. If we used an email address (or SIP URI for that matter) as an example, we&amp;rsquo;d have something like leif@leifmadsen.com where leifmadsen.com would be the domain, and the number 460 would be the equivalent of that. The number 100 would be the unique identifier within that domain, which would represent &amp;lsquo;leif&amp;rsquo; prior to the email &amp;lsquo;at&amp;rsquo; symbol. And finally, you can think of the asterisk in the ISN as the &amp;lsquo;at&amp;rsquo; symbol (@) in the ISN. We could then read 100*460 as &amp;ldquo;extension 100 at ITAD 460&amp;rdquo;. And the 100*460 would then map to the SIP URI of sip:leif@leifmadsen.com (for example).&lt;/p&gt;

&lt;p&gt;This allows a stopgap measure of permitting traditional telephony devices to dial VoIP addresses from their keypad. Because of the nature of VoIP and how a simple URI can actually ring multiple devices, enter into a queue, or an auto-attendant, it doesn&amp;rsquo;t always make sense to utilize a telephone number to represent a SIP URI (see more information about this below in the ENUM section). Perhaps you are a small company with approximately 20 devices, but only 2-3 phone numbers. It doesn&amp;rsquo;t make sense to obtain multiple phone numbers for your company just as a method of dialing a SIP URI from a traditional keypad. In this way, you can assign numbers any which way it makes sense in your company with ISNs.&lt;/p&gt;

&lt;p&gt;The company with 20 extensions could then assign ISNs to each device such as:  201*460, 202*460 &amp;hellip; 220*460. The operator could be 0*460, and perhaps the auto-attendant could be 1*460. There are no set mechanisms or best practices (yet), but as time evolves, perhaps these will come to fruition.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m not sure if ISNs will catch on with the general public, as historically things like ENUM and other services of this nature haven&amp;rsquo;t progressed as much as they likely should, but the idea is sound, and certainly makes more sense to me than having to remember several phone numbers for each extension or location.&lt;/p&gt;

&lt;p&gt;As this is simply an overview about ISNs, I&amp;rsquo;ll stop here. Future articles will delve into the configurations and testing for outbound and inbound calls with Asterisk, setting up DNS, etc. For now, see the &lt;a href=&#34;http://freenum.org&#34;&gt;http://freenum.org&lt;/a&gt; website for more information about configuring these aspects. Unfortunately the Asterisk information is out of date (in terms of utilizing the best features of the dialplan). I&amp;rsquo;d be happy to update the information if enough requests and interest is generated.&lt;/p&gt;

&lt;h2 id=&#34;enumplus:133b4c6dfdac6adcd5cf93b53302f8ac&#34;&gt;ENUMplus&lt;/h2&gt;

&lt;p&gt;ENUMplus (&lt;a href=&#34;http://www.enumplus.org&#34;&gt;http://www.enumplus.org&lt;/a&gt;) is a site which takes the information from several ENUM databases and allows you to perform a single lookup using cURL. Since there is a lot of technology going on in that sentence, lets step back and define each of these aspects.&lt;/p&gt;

&lt;p&gt;I think the wikipedia entry about ENUM does more justice about what it is than what I could do, so lets quote a resource :)&lt;/p&gt;

&lt;p&gt;&amp;ldquo;&lt;strong&gt;Telephone number mapping&lt;/strong&gt; is the process of unifying the &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Telephone&#34;&gt;telephone&lt;/a&gt; number system of the &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Public_switched_telephone_network&#34;&gt;public switched telephone network&lt;/a&gt; with the &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Internet&#34;&gt;Internet&lt;/a&gt; addressing and identification &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Name_space&#34;&gt;name spaces&lt;/a&gt;. Telephone numbers are systematically organized in the &lt;a href=&#34;http://blog.leifmadsen.com/wiki/E.164&#34;&gt;E.164&lt;/a&gt; standard, while the Internet uses the &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Domain_Name_System&#34;&gt;Domain Name System&lt;/a&gt; for linking &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Domain_name&#34;&gt;domain names&lt;/a&gt; to &lt;a href=&#34;http://blog.leifmadsen.com/wiki/IP_address&#34;&gt;IP addresses&lt;/a&gt; and other resource information. Telephone number mapping systems provide facilities to determine applicable Internet communications servers responsible for servicing a given telephone number by simple lookups in the Domain Name System.&lt;/p&gt;

&lt;p&gt;The most prominent facility for telephone number mapping is the E.164 NUmber Mapping (ENUM) standard. It uses special &lt;a href=&#34;http://blog.leifmadsen.com/wiki/DNS_record&#34;&gt;DNS record&lt;/a&gt; types to translate a telephone number into a &lt;a href=&#34;http://blog.leifmadsen.com/wiki/Uniform_Resource_Identifier&#34;&gt;Uniform Resource Identifier&lt;/a&gt; or IP address that can be used in Internet communications.&amp;rdquo; &amp;ndash; wikipedia entry at &lt;a href=&#34;http://en.wikipedia.org/wiki/Telephone_Number_Mapping&#34;&gt;http://en.wikipedia.org/wiki/Telephone_Number_Mapping&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And cURL is a technology that allows you place a request via a website, and have information returned. It is most typically used by programmers to get information from a website without having to parse through the entire site.&lt;/p&gt;

&lt;p&gt;So by marrying these two technologies, ENUM and cURL together, ENUMplus has created a one-stop-shop for performing ENUM lookups. By performing an ENUM lookup prior to placing a call from your Asterisk system, is that if a telephone number has been registered with one of the ENUM organizations and has a SIP URI to point to, then we can utilize that SIP URI instead of calling over the PSTN, which can save toll costs, and free up a circuit for other calls.&lt;/p&gt;

&lt;p&gt;I originally wrote a section of dialplan while testing out the service (which is very quick!) and added it to the ENUMplus wiki page for the configuration of Asterisk 1.6 systems. Originally I had this done as a separate path for dialing that would utilize a prefix of 7 prior to dialing out in order to do an ENUM lookup, and then you could dial without the prefix if you didn&amp;rsquo;t want the lookup (or if the lookup failed). I&amp;rsquo;ve since realized that this method is the wrong approach for obvious reasons (who wants to dial the number twice?), so I have since modified my dialplan to always utilize ENUM lookups prior to placing a call via the PSTN.&lt;/p&gt;

&lt;p&gt;I want to show you the following example from my dialplan, which I&amp;rsquo;ll eventually clean up and add to the ENUMplus wiki.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;exten =&amp;gt; _+1NXXNXXXXXX,1,Set(X=${EXTEN:1})
exten =&amp;gt; _+1NXXNXXXXXX,n,Goto(setCID,1)
exten =&amp;gt; _+NXXNXXXXXX,1,Set(X=1${EXTEN:1})
exten =&amp;gt; _+NXXNXXXXXX,n,Goto(setCID,1)
exten =&amp;gt; _1NXXNXXXXXX,1,Set(X=${EXTEN})
exten =&amp;gt; _1NXXNXXXXXX,n,Goto(setCID,1)
exten =&amp;gt; _NXXNXXXXXX,1,Goto(1${EXTEN},1)

exten =&amp;gt; setCID,1,NoOp()
exten =&amp;gt; setCID,n,Set(CALLERID(name)=LM Enterprises)
exten =&amp;gt; setCID,n,Set(CALLERID(num)=4164790259)
exten =&amp;gt; setCID,n,Goto(lookup,1)

exten =&amp;gt; lookup,1,Verbose(2,Looking up direct dial via ENUM from ENUMPlus: ${X:1})
exten =&amp;gt; lookup,n,Playback(silence/1&amp;amp;doing-enum-lookup)
exten =&amp;gt; lookup,n,Set(CURL_RESULT=${CURL(${GLOBAL(G_ENUMPLUS_API)}/${X:1},key=${GLOBAL(G_ENUMPLUS_KEY)})})
exten =&amp;gt; lookup,n,GotoIf($[${ISNULL(${CURL_RESULT})}]?no_result,1)
exten =&amp;gt; lookup,n,Goto(dial,1)

exten =&amp;gt; dial,1,Verbose(2,Lookup returned:  ${CURL_RESULT})
exten =&amp;gt; dial,n,Playback(enum-lookup-successful)
exten =&amp;gt; dial,n,Dial(${CUT(CURL_RESULT,|,1)},30)
exten =&amp;gt; dial,n,Hangup()

exten =&amp;gt; no_result,1,Verbose(2,ENUMPlus returned no data.)
exten =&amp;gt; no_result,n,Playback(silence/1&amp;amp;enum-lookup-failed)
exten =&amp;gt; no_result,n,Set(OUTBOUND_ROUTE=SIP/${DEFAULT_ITSP_ROUTE})
exten =&amp;gt; no_result,n,Dial(${OUTBOUND_ROUTE}/${X})
exten =&amp;gt; no_result,n,Hangup()
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Load testing SIP registrations with SIPp</title>
      <link>http://blog.leifmadsen.com/blog/2009/07/29/load-testing-sip-registrations-with-sipp/</link>
      <pubDate>Wed, 29 Jul 2009 16:34:49 +0000</pubDate>
      
      <guid>http://blog.leifmadsen.com/blog/2009/07/29/load-testing-sip-registrations-with-sipp/</guid>
      <description>&lt;p&gt;Today I had a need to go and load a bunch of registrations into Asterisk for a bug I was working on. Since I&amp;rsquo;ve had this need a couple of times now, and I keep going and having to redevelop it, I think I&amp;rsquo;ll just write about it here, and then when I need it again, I can just look it up. Maybe this will be useful for someone else as well.&lt;/p&gt;

&lt;p&gt;First of all, this is all based on the post I found on the SipX wiki. You can read the page I based this all off of &lt;a href=&#34;http://sipx-wiki.calivia.com/index.php/Using_SIPp_to_run_performance_tests&#34;&gt;here&lt;/a&gt;. Lots of good info there. All I&amp;rsquo;m really adding of value is the PHP scripts I used to generate the peers in the database, and the register_client.csv file.&lt;/p&gt;

&lt;p&gt;First, lets load a bunch of peers into Asterisk. I&amp;rsquo;m loading peers numbered 101 &amp;ndash;&amp;gt; 199.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;&amp;lt;?php

if (!$link = mysql_connect(&#39;localhost&#39;,&#39;asterisk&#39;,&#39;asterisk&#39;)) {
	echo &amp;quot;Could not connect\n&amp;quot;;
	die(mysql_error());
}

if (!mysql_select_db(&#39;asterisk&#39;,$link)) {
	echo &amp;quot;Could not get into database\n&amp;quot;;
	die(mysql_error());
}

for($counter = 100; $counter &amp;lt;= 199; $counter++) {
	$sql = &amp;quot;INSERT INTO sipfriends (type,name,username,secret,context,canreinvite,nat,host,mailbox,dtmfmode,disallow,allow) VALUES (&#39;friend&#39;,&#39;$counter&#39;,&#39;$counter&#39;,&#39;welcome&#39;,&#39;start&#39;,&#39;no&#39;,&#39;yes&#39;,&#39;dynamic&#39;,&#39;$counter@default&#39;,&#39;rfc2833&#39;,&#39;all&#39;,&#39;ulaw&#39;)&amp;quot;;
	echo $sql.&amp;quot;\n&amp;quot;;
	$result = mysql_query($sql,$link);
	if (!$result) {
		echo &amp;quot;DB error &amp;quot; . mysql_error();
		exit;
	}
}

mysql_close($link);

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Next, we need to generate the register_client.csv file in order to tell SIPp which peers to authenticate, and how.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;&amp;lt;?php

$myFile = &amp;quot;register_client.csv&amp;quot;;
$fh = fopen($myFile, w);

for ($counter = 100; $counter &amp;lt;= 199; $counter++) {
	$data = &amp;quot;$counter;example.com;[authentication username=$counter password=welcome];\n&amp;quot;;
	fwrite($fh, $data);
}

fclose($fh);

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And finally, here is the line used to send a bunch of registrations to Asterisk. If you want to do a load test, you may need to adjust the numbers so it does a better job of &amp;ldquo;blasting&amp;rdquo; the end point you want to test.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sipp -sf register_client.xml -inf register_client.csv -r 10 -trace_err -trace_stat -nd -fd 1 -i  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have any questions, just ask, and I&amp;rsquo;ll try to comment here. This post is potentially light on specifics since these are notes for my future reference.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>